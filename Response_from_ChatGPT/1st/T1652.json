{
  "id":"chatcmpl-8ODFPCTpL4ntlM6YrorAZ3MbrZ8Wr",
  "object":"chat.completion",
  "created":1700781487,
  "model":"gpt-3.5-turbo-0613",
  "choices":[
    {
      "index":0,
      "message":{
        "role":"assistant",
        "content":"[可實現]\n\n使用Python的pywin32套件，我們可以使用WMI (Windows Management Instrumentation)來列舉本地設備驅動程式。以下是三種實現方式：\n\n方法一：使用pywin32套件的WMI功能\n```python\nimport win32com.client\n\ndef enumerate_device_drivers():\n    wmi = win32com.client.GetObject(\"winmgmts:\")\n    drivers = wmi.InstancesOf(\"Win32_PnPSignedDriver\")\n\n    for driver in drivers:\n        print(f\"Device Name: {driver.DeviceName}\")\n        print(f\"Manufacturer: {driver.Manufacturer}\\n\")\n\nenumerate_device_drivers()\n```\n\n方法二：使用pywin32套件的WMI功能，匯出結果到CSV檔案\n```python\nimport csv\nimport win32com.client\n\ndef enumerate_device_drivers_csv(filename):\n    wmi = win32com.client.GetObject(\"winmgmts:\")\n    drivers = wmi.InstancesOf(\"Win32_PnPSignedDriver\")\n\n    with open(filename, 'w', newline='') as file:\n        writer = csv.writer(file)\n        writer.writerow([\"Device Name\", \"Manufacturer\"])\n\n        for driver in drivers:\n            writer.writerow([driver.DeviceName, driver.Manufacturer])\n\nenumerate_device_drivers_csv(\"device_drivers.csv\")\n```\n\n方法三：使用Python的wmi套件\n```python\nimport wmi\n\ndef enumerate_device_drivers():\n    c = wmi.WMI()\n    drivers = c.Win32_PnPSignedDriver()\n\n    for driver in drivers:\n        print(f\"Device Name: {driver.DeviceName}\")\n        print(f\"Manufacturer: {driver.Manufacturer}\\n\")\n\nenumerate_device_drivers()\n```\n\n這些方法都能列舉本地設備驅動程式的名稱和製造商。你可以根據需要選擇適合的方法來實現。"
      },
      "finish_reason":"stop"
    }
  ],
  "usage":{
    "prompt_tokens":632,
    "completion_tokens":437,
    "total_tokens":1069
  }
}